apply plugin: 'idea'
apply plugin: 'groovy'
//apply plugin: 'application'

//mainClassName = 'org.yila.gscript'

def appName = 'GrooScript'
def webDir = '../gscript-web/webapp'
def webDirJar = "$webDir/jar"
def webDirExamples = "$webDir/web/examples/"
def webDirJs = "$webDir/web/scripts/"

def examplesDir = 'src/test/resources/'
def webExamples = [:]
webExamples.putAt 'MysticTable',"${examplesDir}advanced/MysticTable.groovy"
webExamples.putAt 'ExpandoTree',"${examplesDir}advanced/Tree.groovy"

repositories {
    mavenCentral()
    //maven {
    //    url "http://oss.sonatype.org/content/repositories/snapshots/"
    //}
}

dependencies {
	groovy group: 'org.codehaus.groovy', name: 'groovy', version: '2.0.5'
	//missing spock for groovy 2
    testCompile 'org.spockframework:spock-core:0.7-groovy-2.0'
	//testCompile 'junit:junit:4.10'
	//testCompile fileTree(dir: 'lib', include: '*.jar')
}

task copyToGscriptWeb(dependsOn: build) << {
	println "Copying $appName jar to $webDirJar ..."
	copy {
		into "$webDirJar"
		from "build/libs"			
		include "**/*.jar"
	}
	
	println "Copying $appName jsFiles to $webDirJs ..."
	copy {
		into "$webDirJs"
		from "src/main/resources/js"			
		include "**/*.*"
		exclude "test.js"
	}
	
	println "Copying $appName examples to $webDirExamples ..."
	webExamples.each { key, value ->
		copy {
			into "$webDirExamples"
			from "$value"			
			rename { 
				return "${key}.groovy"
			}
		}
	}
	
}